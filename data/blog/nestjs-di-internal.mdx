---
title: 'Nestjs: Dependency Injection Internals'
h1: 'Nestjs: Dependency Injection Internals'
date: '2022-11-25'
lastmod: '2022-11-25'
draft: false
summary: Nestjs Dependency Injection Internals
images: ['/static/images/nestjs-internal.jpeg']
---

![](/static/images/nestjs-internal.jpeg)

### Intro

ì†Œë§ˆ 13ê¸°ë¥¼ í•˜ë©´ì„œ ì²˜ìŒìœ¼ë¡œ ë°±ì—”ë“œ í¬ì§€ì…˜ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í–ˆê³ , ì²˜ìŒìœ¼ë¡œ [Nestjs](https://nestjs.com/)ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆë‹¤. NestjsëŠ” Nodejs ëŸ°íƒ€ì„ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì„œë²„ì‚¬ì´ë“œ í”„ë ˆì„ì›Œí¬ ì¤‘ í•˜ë‚˜ë¡œ OOP/FP/FRPì˜ ìš”ì†Œë“¤ì„ ê²°í•©í•´ì„œ íš¨ìœ¨ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ìˆ˜ ìˆë„ë¡ í•œë‹¤.

ì‚¬ì‹¤ Nodejsì—ëŠ” ë”±íˆ â€˜êµ¬ì¡°â€™ì ì¸ ì„œë²„ì‚¬ì´ë“œ í”„ë ˆì„ì›Œí¬ë„ ê²Œ ì—†ì—ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ [Express](https://expressjs.com/ko/)ëŠ” ììœ ë„ì˜ ëíŒì™•ì´ë¼ í”„ë¡œì íŠ¸ê°€ ì»¤ì§ˆìˆ˜ë¡ ê°œë°œì ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ì•”ë¬µì ì¸ íŒ¨í„´ì„ ë§Œë“œëŠ” ì£¼ê°ì´ ì „ë„ëœ(?) ìƒí™©ì´ ë°œìƒí•˜ê²Œ ëœë‹¤. Nestjsê°€ í•´ê²°í•˜ê³ ì í–ˆë˜ ë¬¸ì œê°€ ë°”ë¡œ â€˜êµ¬ì¡°â€™ ë¬¸ì œì´ê³ , ê·¸ëŸ¬ë‹¤ ë³´ë‹ˆ Springê³¼ ìœ ì‚¬í•œ ëª¨ìŠµì„ ëˆë‹¤ëŠ” í‰ê°€ê°€ ë§ë‹¤. ì‹¤ì œë¡œ NestjsëŠ” under the hoodì—ì„œ Expressë¥¼ http server í”„ë ˆì„ì›Œí¬ë¡œ ì‚¬ìš©í•˜ê³  ì´ë¥¼ ì¶”ìƒí™”í•´ì„œ ìš°ë¦¬ì—ê²Œ ì œê³µí•´ì¤€ë‹¤.

ìµœê·¼ [ëª¨ ê°œë°œìì˜ insaneí•œ ìŠ¬ë™ë´‡ ê°œë°œê¸°](https://velog.io/@hanchchch/ì§„ì‹¬ìœ¼ë¡œ-ì—…ë¬´-ìë™í™”-ìŠ¬ë™ë´‡-ë§Œë“¤ê¸°-1)ë¥¼ ì½ê³  ë‚˜ë„ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ë¡œ ë§Œë“¤ì–´ ë³´ê³  ì‹¶ì€ íŒ¨í‚¤ì§€ê°€ ìƒê²¨ ë‚´ë¶€ì ì¸ ì›ë¦¬ë¥¼ ì•Œì•„ë³´ê³ ì Nestjs internalì„ ê³µë¶€í•˜ê²Œ ëë‹¤. ê·¸ ì¤‘ì—ì„œ ì´ë²ˆ ê¸€ì—ì„œëŠ” Nestjsì˜ í•µì‹¬ì¸ **ì˜ì¡´ì„± ì£¼ì…**(Dependency Injection)ì´ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ì´ë¤„ì§€ëŠ”ì§€ ì•Œì•„ë³´ë ¤ê³  í•œë‹¤.

**Letâ€™s Deep Dive!** ğŸš€

### Scene

í…ŒìŠ¤íŠ¸ì™€ ë””ë²„ê¹…ì„ ìœ„í•´ ì‘ì€ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì—ˆë‹¤. ì´ í”„ë¡œì íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê¸€ì„ ì´ì–´ê°„ë‹¤. ê° 1ê°œì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì„œë¹„ìŠ¤ë¥¼ ê°€ì§€ëŠ” ëª¨ë“ˆì„ 4ê°œ ë§Œë“¤ì—ˆë‹¤.

```
src
â”œâ”€â”€ app
â”‚   â”œâ”€â”€ app.controller.ts
â”‚   â”œâ”€â”€ app.module.ts
â”‚   â””â”€â”€ app.service.ts
â”œâ”€â”€ cat
â”‚   â”œâ”€â”€ cat.controller.ts
â”‚   â”œâ”€â”€ cat.module.ts
â”‚   â””â”€â”€ cat.service.ts
â”œâ”€â”€ dog
â”‚   â”œâ”€â”€ dog.controller.ts
â”‚   â”œâ”€â”€ dog.module.ts
â”‚   â””â”€â”€ dog.service.ts
â”œâ”€â”€ main.ts
â””â”€â”€ naming
    â”œâ”€â”€ naming.controller.ts
    â”œâ”€â”€ naming.module.ts
    â””â”€â”€ naming.provider.ts
```

ëª¨ë“ˆë“¤ì˜ `imports` êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```
AppModule
  imports: [CatModule, DogModule, NamingModule]

CatModule
  imports: [NamingModule]

DogModule
  imports: []

NamingModule
  imports: []
```

### Where is the entry point of Dependency Scanning

DIëŠ” IoC(Inversion of Control)ì˜ ìˆ˜ë‹¨ì´ë‹¤. ì´ë¥¼ ìœ„í•´ì„œ Nestjsê°€ dependencyë¥¼ scaní•  ìˆ˜ ìˆì–´ì•¼ í•˜ê³ , scaní•œ dependencyë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ë¨¼ì € ì´ í•¨ìˆ˜ë“¤ì´ ì–´ë””ì„œ í˜¸ì¶œë˜ëŠ”ì§€ ì°¾ì•„ë³´ì.

NestjsëŠ” í”„ë¡œì íŠ¸ ìƒì„± ì‹œ `main.ts` íŒŒì¼ì„ ì œê³µí•˜ê³ , ê·¸ íŒŒì¼ì—ëŠ” `bootstrap` ì´ë¼ëŠ” ê°„ë‹¨í•œ í•¨ìˆ˜ê°€ ìˆë‹¤.

```typescript
async function bootstrap() {
  const app = await NestFactory.create(AppModule)
  app.listen(3000, () => {
    console.info('[+] ğŸš€ Server listening on 3000')
  })
}
bootstrap()
```

`bootstrap`ì€ appì„ ë§Œë“¤ê³ , appì„ listení•˜ê²Œ í•˜ëŠ” ê°„ë‹¨í•œ í•¨ìˆ˜ë‹¤. ìš°ë¦¬ê°€ ì£¼ëª©í•  ê³³ì€ â€˜appì„ ë§Œë“œëŠ”â€™ ë¶€ë¶„ì¸ `NestFactory.create` í•¨ìˆ˜ì´ë‹¤.

- [**@nestjs/core/nest-factory.ts#L65**](https://github.com/nestjs/nest/blob/master/packages/core/nest-factory.ts#L65)**: create**

`NestContainer` ì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ `container` ì™€ ìš°ë¦¬ê°€ ì¸ìë¡œ ë„˜ê²¨ì¤¬ë˜ `AppModule` ì¸ `module` ì„ ê°€ì§€ê³  `initialize` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. `NestContainer` ëŠ” ëª¨ë“ˆë“¤ì˜ ëª¨-ë“  ì •ë³´ë¥¼ ë‹´ëŠ” í´ë˜ìŠ¤ë¡œ, ì•±ì˜ êµ¬ì„±ë„ ì—­í• ì„ í•œë‹¤.

- [**@nestjs/core/nest-factory.ts#L155**](https://github.com/nestjs/nest/blob/220b098e220b1e3471493d036425d525a951e566/packages/core/nest-factory.ts#L155)**: initialize**

`initialize` í•¨ìˆ˜ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `scan` ê³¼ `createInstancesOfDependencies` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. `createInstancesOfDependencies` ëŠ” `scan`ì„ í†µí•´ ì–»ì€ ê²°ê³¼ë¥¼ ì‹¤ì œë¡œ ì¸ìŠ¤í„´ìŠ¤í™” í•˜ëŠ” í•¨ìˆ˜ë‹¤.

### How does the Module scanning work

ì´ì œ scanì´ ì–´ë””ì„œ ì´ë£¨ì–´ì§€ëŠ”ì§€ ì•Œì•˜ë‹¤. ì§€ê¸ˆê¹Œì§€ ì½œìŠ¤íƒì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

![img](https://cdn-images-1.medium.com/max/1600/1*1mZ4ZSGyjPEzss6zrm6-Dw.png)

main.tsì—ì„œ bootstrapì„ ì‹¤í–‰í–ˆê³ , `NestFactory.create` í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ `initialize` ë¥¼ ì‹¤í–‰í–ˆë‹¤. ì´ì œ `initialize`ì—ì„œ DependenciesScannerì˜ `scan` ë©”ì†Œë“œê¹Œì§€ ì‹¤í–‰í•´ì•¼ í•œë‹¤.

[**@nestjs/core/scanner.ts#L70**](https://github.com/nestjs/nest/blob/220b098e220b1e3471493d036425d525a951e566/packages/core/scanner.ts#L70)**: scan**

```typescript
  public async scan(module: Type<any>) {
    await this.registerCoreModule();
    // ==== [*] Important ====
    await this.scanForModules(module);
    await this.scanModulesForDependencies();
    this.calculateModulesDistance();

    this.addScopedEnhancersMetadata();
    this.container.bindGlobalScope();
  }
```

`scan` í•¨ìˆ˜ëŠ” ìš°ë¦¬ê°€ ì¸ìë¡œ ì œê³µí–ˆë˜ `AppModule` ì„ ì‹œì‘ìœ¼ë¡œ DFS ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ëª¨ë“ˆì„ íƒìƒ‰í•˜ë©° `NestContainer`ì— ì´ë¥¼ ì €ì¥í•˜ê³ , ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±ì„ í™•ë¦½í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.

`scanForModules` ëŠ” ì „ìì— í•´ë‹¹í•˜ë©°, `imports`ë¥¼ ì´ìš©í•´ ëª¨ë“ˆë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ containerì— ëª¨ë“ˆì˜ ì •ë³´ë¥¼ ë‹´ëŠ” í•¨ìˆ˜ì´ë‹¤.

[**@nestjs/core/scanner.ts#L80**](https://github.com/nestjs/nest/blob/220b098e220b1e3471493d036425d525a951e566/packages/core/scanner.ts#L80)**: scanForModules**

```typescript
public async scanForModules(
    moduleDefinition:
      | ForwardReference
      | Type<unknown>
      | DynamicModule
      | Promise<DynamicModule>,
    scope: Type<unknown>[] = [],
    ctxRegistry: (ForwardReference | DynamicModule | Type<unknown>)[] = [],
  ): Promise<Module[]> {

    const moduleInstance = await this.insertModule(moduleDefinition, scope);
    ctxRegistry.push(moduleDefinition);

    ...

    // ==== [*] Importants ====
    // I edited code for simplicity. Please check original code in github
    const modules = this.reflectMetadata(
          MODULE_METADATA.IMPORTS,
          moduleDefinition as Type<any>,
    )

    ...

    let registeredModuleRefs = [];
    // ==== [*] Importants ====
    for (const [index, innerModule] of modules.entries()) {

      ...

      // ==== [*] Importants ====
      // DFS
      const moduleRefs = await this.scanForModules(
        innerModule,
        [].concat(scope, moduleDefinition),
        ctxRegistry,
      );

      ...
    }
    if (!moduleInstance) {
      return registeredModuleRefs;
    }
    return [moduleInstance].concat(registeredModuleRefs);
  }
```

ì½”ë“œì— ë¹„í•´ ë‚´ìš©ì€ ë‹¨ìˆœí•˜ë‹¤.

- `moduleInstance`: NestjsëŠ” ìš°ë¦¬ê°€ ì •ì˜í•œ classì— token, id, ì˜ì¡´ì„± ë“±ì„ ì¶”ê°€í•œ `Module` í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤. ê·¸ë¦¬ê³  ì´ë¥¼ `NestContainer` ì¸ìŠ¤í„´ìŠ¤ì— ì¶”ê°€í•œë‹¤.
- `modules`: í˜„ì¬ ëª¨ë“ˆì˜ `imports`ë¥¼ í™•ì¸í•˜ê³ , ìˆœíšŒí•´ì•¼ í•  ëª¨ë“ˆ ëª©ë¡ì„ í™•ì¸í•œë‹¤.
- `for loop`: DFSë¡œ ëŒë©´ì„œ `NestContainer` ì— ëª¨ë“  ëª¨ë“ˆì„ ì¶”ê°€í•œë‹¤.

ì¬ë°ŒëŠ” ë¶€ë¶„ì€ ëª¨ë“ˆì˜ `imports` ë¥¼ í™•ì¸í•˜ê³  ë‹¤ìŒ ìˆœíšŒí•  ëª¨ë“ˆì„ í™•ì¸í•˜ëŠ” ë¶€ë¶„ì´ë‹¤. ì´ ë•Œ `reflectMetadata` ë¥¼ ì‚¬ìš©í•˜ëŠ”ë°, ì´ ì¹œêµ¬ë¥¼ ì´í•´í•˜ë©´ Nestjsì—ì„œ ì œê³µí•˜ëŠ” ë°ì½”ë ˆì´í„°ë“¤ì˜ ì—­í• ì„ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ ì¢€ ìì„¸íˆ ì•Œì•„ë³´ê³  ë‹¤ì‹œ ëŒì•„ì˜¤ì.

[**@nestjs/core/scanner.ts#L414**](https://github.com/nestjs/nest/blob/220b098e220b1e3471493d036425d525a951e566/packages/core/scanner.ts#L414)**: reflectMetadata**

```typescript
reflectMetadata(metadataKey, metatype) {
        return Reflect.getMetadata(metadataKey, metatype) || [];
    }
```

í´ë˜ìŠ¤ì— ë©”íƒ€ë°ì´í„°ë¥¼ consistentí•œ ë°©ì‹ìœ¼ë¡œ ì§€ì •í•˜ëŠ” [reflect-metdata](https://www.npmjs.com/package/reflect-metadata) íŒ¨í‚¤ì§€ê°€ ìˆë‹¤. `Reflect.getMetadata`ëŠ” ì´ íŒ¨í‚¤ì§€ì—ì„œ ì œê³µí•˜ëŠ” API ì¤‘ í•˜ë‚˜ë‹¤.

_ps. ì´ íŒ¨í‚¤ì§€ì˜ ë‚´ìš©ì„ í‘œì¤€ì— ì¶”ê°€í•˜ìëŠ” ìˆ˜ìš”ê°€ ë§ìŒì—ë„, Decoratorê°€ ì•„ì§ TC39 í”„ë¡œì„¸ìŠ¤ ì¤‘ [Stage 3](https://github.com/tc39/proposal-decorators)ì— ìˆì–´ì„œì¸ì§€, ECMA ìŠ¤í¬ë¦½íŠ¸ í‘œì¤€ì— ì´ íŒ¨í‚¤ì§€ ì ìš©ì„ ì œì•ˆí•˜ëŠ” [proposalì„ ì•„ì§ ì œì¶œí•˜ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤.](https://github.com/rbuckton/reflect-metadata/issues/9)_

```typescript
this.reflectMetadata(constants_1.MODULE_METADATA.IMPORTS, moduleDefinition)

/*
https://github.com/nestjs/nest/blob/220b098e220b1e3471493d036425d525a951e566/packages/common/constants.ts#L1
export const MODULE_METADATA = {
  IMPORTS: 'imports',
  PROVIDERS: 'providers',
  CONTROLLERS: 'controllers',
  EXPORTS: 'exports',
};
*/
```

ì´ ì½”ë“œëŠ” í•´ë‹¹ ëª¨ë“ˆì— ì •ì˜ëœ ë©”íƒ€ë°ì´í„° ì¤‘ `imports`ì— í•´ë‹¹í•˜ëŠ” ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œë‹¤. ê·¸ëŸ¼ ì´ ë©”íƒ€ë°ì´í„°ëŠ” ì–´ë””ì„œ ì •ì˜í•˜ëŠ” ê±¸ê¹Œ? ì—¬ê¸°ì„œ Nestjsì˜ Decorator magicì´ ì‚¬ìš©ëœë‹¤.

[**@nestjs/common/decorators/modules/module.decorator.ts#L18**](https://github.com/nestjs/nest/blob/220b098e220b1e3471493d036425d525a951e566/packages/common/decorators/modules/module.decorator.ts#L18)**:**

```typescript
export function Module(metadata: ModuleMetadata): ClassDecorator {
  const propsKeys = Object.keys(metadata)
  validateModuleKeys(propsKeys)

  return (target: Function) => {
    for (const property in metadata) {
      if (metadata.hasOwnProperty(property)) {
        Reflect.defineMetadata(property, (metadata as any)[property], target)
      }
    }
  }
}

/*
@Module({
  imports: [CatModule, DogModule, NamingModule],
  controllers: [AppController],
  providers: [AppService],
})
export class AppModule {}
*/
```

ìœ„ ì½”ë“œì—ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ì´, `@Module`, `@Controller`, `@Injectable`, ë“± Nestjsì—ì„œ ì œê³µí•˜ëŠ” ë§ì€ ë°ì½”ë ˆì´í„°ë“¤ì´ í•˜ëŠ” ì¼ì€ `Reflect.defineMetadata`ë¥¼ ì´ìš©í•œ **ë©”íƒ€ë°ì´í„° ì •ì˜**ê°€ ì „ë¶€ì´ë‹¤.

ë°ì½”ë ˆì´í„°ëŠ” class declarationì´ ì‹¤í–‰ë  ë•Œ í•¨ê»˜ ì‹¤í–‰ë˜ê³ , top-level ìŠ¤ì½”í”„ì—ì„œ í´ë˜ìŠ¤ë¥¼ ì •ì˜í–ˆê¸° ë•Œë¬¸ì— `import` statementê°€ ì‹¤í–‰ë  ë•Œ ë°ì½”ë ˆì´í„°ê°€ ì‹¤í–‰ë˜ë©´ì„œ ë©”íƒ€ë°ì´í„°ê°€ ì •ì˜ëœë‹¤. ì¦‰, main.tsì—ì„œ `AppModule`ì„ importí•  ë•Œ, `AppModule` í´ë˜ìŠ¤ ì •ì˜ê°€ ì‹¤í–‰ë˜ë©´ì„œ `@Module` ë°ì½”ë ˆì´í„°ê°€ ì‹¤í–‰ë˜ê³ , ë©”íƒ€ë°ì´í„°ê°€ ë“±ë¡ëœë‹¤. `app.module.ts`ì—ì„œ importëœ ëª¨ë“  ëª¨ë“ˆê³¼ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ í”„ë¡œë°”ì´ë”ì— ëŒ€í•´ì„œë„ ê°™ì€ ì¼ì´ ì¼ì–´ë‚˜ê¸° ë•Œë¬¸ì—, `bootstrap` ì´ ì‹¤í–‰ë˜ê¸° ì „ í•„ìš”í•œ ë©”íƒ€ë°ì´í„°ê°€ ëª¨ë‘ ì •ì˜ëœ ìƒíƒœê°€ ëœë‹¤.

```typescript
// Decorator executed when it's target is imported
// if target is declared in top-level scope
import { AppModule } from './app/app.module'
```

ì´ì œ ì–´ë–»ê²Œ Nestjsê°€ scaní•  ëª¨ë“ˆì„ ì°¾ê³ , ì´ë¥¼ `NestContainer`ì— ì¶”ê°€í•˜ëŠ”ì§€ ì•Œì•˜ë‹¤. `scanForModules`ê°€ ëë‚˜ë©´ containerì— ëŒ€ëµ ë‹¤ìŒê³¼ ê°™ì€ ëª¨ìŠµìœ¼ë¡œ Moduleì´ ì €ì¥ë˜ì–´ ìˆë‹¤.

![img](https://cdn-images-1.medium.com/max/1600/1*ktLO-Im8PzxZSlAA1g5hyQ.png)

### How does Dependency scanning work

Moduleì„ ë‹¤ ì°¾ì•˜ìœ¼ë‹ˆ, ì´ì œ ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±ì„ ìŠ¤ìº”í•  ì°¨ë¡€ë‹¤.

[**@nestjs/core/scanner.ts#L158**](https://github.com/nestjs/nest/blob/master/packages/core/scanner.ts#L158)**: scanModulesForDependencies**

```typescript
public async scanModulesForDependencies(
    modules: Map<string, Module> = this.container.getModules(),
  ) {
    for (const [token, { metatype }] of modules) {
      await this.reflectImports(metatype, token, metatype.name);
      this.reflectProviders(metatype, token);
      this.reflectControllers(metatype, token);
      this.reflectExports(metatype, token);
    }
}

// @nestjs/core/scanner.ts#L200
public reflectControllers(module: Type<any>, token: string) {
    const controllers = [
      ...this.reflectMetadata(MODULE_METADATA.CONTROLLERS, module),
      ...this.container.getDynamicMetadataByToken(
        token,
        MODULE_METADATA.CONTROLLERS as 'controllers',
      ),
    ];
    controllers.forEach(item => {
      this.insertController(item, token);
      this.reflectDynamicMetadata(item, token);
    });
}

/*
https://github.com/nestjs/nest/blob/220b098e220b1e3471493d036425d525a951e566/packages/common/constants.ts#L1
export const MODULE_METADATA = {
  IMPORTS: 'imports',
  PROVIDERS: 'providers',
  CONTROLLERS: 'controllers',
  EXPORTS: 'exports',
};
*/
```

- `this.container.getModules` ëŠ” ë°”ë¡œ ìœ„ ì‚¬ì§„ì˜ `Array<Map>` ì„ ë¦¬í„´í•œë‹¤.

ë§ˆì°¬ê°€ì§€ë¡œ ë©”íƒ€ë°ì´í„° ë°”íƒ•ìœ¼ë¡œ `imports`, `providers`, `controllers`, `exports`ë¥¼ ê°€ì ¸ì™€ì„œ ê° ëª¨ë“ˆì— ì¶”ê°€í•´ì•¼ í•œë‹¤. ì´ì „ í•¨ìˆ˜ì™€ ê°™ì€ ì‘ì—…ì„ ë°˜ë³µí•˜ëŠ” ë¶€ë¶„ì´ë¯€ë¡œ ê°„ë‹¨íˆ ë„˜ì–´ê°€ê³ , ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

![img](https://cdn-images-1.medium.com/max/1600/1*8QwmQ5ANlOfrIf1ETIiFQw.png)

`scanForModules`ì™€ `scanModulesForDependencies`ì˜ ì°¨ì´ëŠ” ì „ìëŠ” `NestContainer`ì— moduleì„ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì´ê³ , í›„ìëŠ” ê·¸ë ‡ê²Œ ì¶”ê°€í•œ moduleì— controller, provider ë“±ì„ ì¶”ê°€í•˜ëŠ” ê³¼ì •ì´ë¼ëŠ” ì ì´ë‹¤.

ì´ ê³¼ì •ê¹Œì§€ ê±°ì¹˜ë©´, ë“œë””ì–´ ëª¨ë“  ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±ì´ í™•ë¦½ë˜ì—ˆë‹¤!

### Conclusion & More

Nestjs ë¶„ì„ì„ í†µí•´ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ **Dependency Injection**ì´ ì´ë£¨ì–´ì§€ê³  ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ê·¸ë¦¬ê³  ì½”ë“œë¥¼ ë¶„ì„í•˜ëŠ” ê³¼ì •ì—ì„œ `NestContainer`ê°€ ì˜ì¡´ì„± ê´€ë ¨ ëª¨ë“  ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤ëŠ” ì‚¬ì‹¤ë„ ì•Œì•˜ë‹¤.

Typescriptì˜ `private` í‚¤ì›Œë“œëŠ” jsë¡œ íŠ¸ëœìŠ¤íŒŒì¼ë˜ë©´ì„œ ì‚¬ë¼ì§€ê¸° ë•Œë¬¸ì— `any` íƒ€ì…ì˜ containerëŠ” NestApplicationì˜ í”„ë¡œí¼í‹°ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê³ , `NestFactory.create`ì˜ ë¦¬í„´ê°’ì´ `NestApplication`ì˜ í”„ë¡ì‹œë¥¼ ì”Œìš´ ê²ƒì´ê¸° ë•Œë¬¸ì— ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì—ì„œ `app.container` ë¡œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¸ë˜ì„œ ì‹¤ì œë¡œ containerì— ì ‘ê·¼í•´ì„œ ì˜ì¡´ì„± ê´€ê³„ë¥¼ [ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” íŒ¨í‚¤ì§€](https://github.com/jmcdo29/nestjs-spelunker)ë„ ìˆë‹¤.

NestjsëŠ” ë¼ìš°íŒ…í•˜ëŠ” ë°©ì‹ë„ ì¬ë°Œì–´ì„œ, ì´ê²ƒë„ ë‚˜ì¤‘ì— ê¸€ë¡œ ì“°ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤. ì˜¤ëœë§Œì— ê¿€ì¼ ë¶„ì„í•œ ê²ƒ ê°™ì•„ì„œ ê¸°ë¶„ì´ ì¢‹ë‹¤. ê¸´ ê¸€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!

![img](https://cdn-images-1.medium.com/max/1600/0*4F-nYp7PALxtwF9W)

### References

[**GitHub - nestjs/nest: A progressive Node.js framework for building efficient, scalable, andâ€¦**](https://github.com/nestjs/nest/)

[**ì§„ì‹¬ìœ¼ë¡œ ì—…ë¬´(?) ìë™í™” ìŠ¬ë™ë´‡ ë§Œë“¤ê¸° (1)**](https://velog.io/@hanchchch/ì§„ì‹¬ìœ¼ë¡œ-ì—…ë¬´-ìë™í™”-ìŠ¬ë™ë´‡-ë§Œë“¤ê¸°-1)

[**GitHub - rbuckton/reflect-metadata: Prototype for a Metadata Reflection API for ECMAScript**](https://github.com/rbuckton/reflect-metadata)
